@using Microblogging.Core.Models
<!-- Views/Posts/Index.cshtml -->
@model IEnumerable<Post>

<h2>Timeline</h2>

@foreach (var post in Model)
{
    <div class="post">
        <h4>@post.User.Username</h4>
        <p>@post.Content</p>
        @if (!string.IsNullOrEmpty(post.OriginalImageUrl))
        {
            <img src="@post.OriginalImageUrl"
                 alt="Post image"
                 style="max-width: 500px;" />
        }
        <small>@post.CreatedAt.ToString("g")</small>
    </div>
}
<script>
    // Client-side code will handle all data fetching
    const token = '@ViewBag.JwtToken';

    async function loadPosts() {
        const response = await fetch('/api/posts', {
            headers: {
                'Authorization': `Bearer ${token}`,
                'X-Screen-Width': window.screen.width,
                'X-Screen-Height': window.screen.height
            }
        });
        // ... render posts
    }

    document.addEventListener('DOMContentLoaded', loadPosts);
</script>